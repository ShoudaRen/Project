<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="renderer" content="webkit" />
		<title>Booking System</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!--导入核心文件-->
		<script src="../bootstrap3/js/holder.js"></script>
		<script src="../js/jquery-1.9.1.min.js"></script>
		<!-- 字体图标 -->
		<link rel="stylesheet" href="../fontAwesome/css/all.css">
	    <link rel="stylesheet" href="../CSS/base.css">
		<link rel="stylesheet" href="../CSS/standardhead.css">
		<link rel="stylesheet" href="../CSS/footer.css">
        <link rel="icon" href="../static/ICON.png" type="image/x-icon">


		<style>
			.orders-table{
				width: 1000px;
			}

            .panel, .panel-default{
                margin-top: 70px;
                width: 1200px;
            }


            .orders-table{
                width: 1300px;
            }

            .superBottom{
                position: absolute;
                top: 100%;
            }
            .confirm_but button{
                display: block;
                width: 50px;
                height: 27px;
                color:white;
                background-color: brown;
                text-align: center;
                line-height: 27px;
                border-radius: 12%;
            }

		</style>
	</head>




	<body>

	<div class="top">
		<div class="mid w">
			<div class="logo"><a href="./index.html"><img src="../static/logo.png" alt="logo"></a></div>
			<div class="user">
				<div id="tel"><i class="fa fa-phone"></i> TEL:88888888</div>
				<div class="service"> <i class="fa fa-user"> </i><a href="../templates/LogIn.html"></i> LOG IN</a> </div>
				<div>/</div>
				<div class="service"> <a href="../templates/register.html"> SIGN UP</a></div>
			</div>
		</div>
	</div>
	<div class="secondmid w">
		<div><a href="javascript:;">Help and Contacts</a></div>
		<div class="SpecialOffer"><a id="qw" href="javascript:;">Special Offers</a>
			<div id="demo" class="secondBox">
				<div class="Voucher"><a href="javascript:;">Voucher</a> </div>
				<div class="speicals"><a href="javascript:;">Flight speicals</a></div>
			</div>
		</div>
		<div id="changeManage"><a href="javascript:;">Manage</a></div>
		<div><a href="javascript:;">About Us</a></div>
	</div>

		<!--头部结束-->
		<!--导航结束-->
		<div class="w">
			<!--左侧导航结束-->
			<div class="col-md-10 ">
				<div class="panel panel-default">
					<div class="panel-body">
						<table class="orders-table" width="100%">
							<thead>
								<tr>
									<th width="3%">Airline</th>
									<th width="3%">Flight Number</th>
									<th width="2%">Day</th>
									<th width="3%">Departure Time</th>
									<th width="3%">Arrival Time</th>
									<th width="2%">From</th>
									<th width="2%">To</th>
									<th width="2%">Economy</th>
                                    <th width="2%">Business</th>
									<th width="5%">First</th>
								</tr>
							</thead>
							<tbody id="flight-body">
<!--								<tr>-->
<!--									<td>BritishAirway</td>-->
<!--									<td>GP2312</td>-->
<!--									<td>day</td>-->
<!--									<td>time1</td>-->
<!--									<td>time2</td>-->
<!--									<td>London</td>-->
<!--									<td>Paris</td>-->
<!--                                    <td>£<span>eco</span><div class='confirm_but'> <button onclick='economyClik(#{flightId})' >Book</button> </div></td>-->
<!--                                    <td>£<span>busin</span> <div class='confirm_but'><button onclick='economyClik(#{flightId})' >Book</button> </div></td>-->
<!--									<td>£<span>first</span><div  class='confirm_but'><button onclick='economyClik(#{flightId})' >Book</button> </div></td>-->
<!--						       </tr>-->

							</tbody>
						</table>
						<div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--页脚开始-->
		<div class="superBottom">
			<div class="bottomMiddle w">
				<div class="bottomF">
					<div><a href="javascript:;">Help and contacts</a></div>
					<div class="mark">|</div>
					<div><a href="javascript:;">About Us</a></div>
					<div class="mark">|</div>
					<div><a href="javascript:;">Manage</a></div>
					<div class="mark">|</div>
					<div><a href="javascript:;">Special Offers</a></div>
					<div class="mark">|</div>
					<div><a href="javascript:;">Privacy policy</a></div>
					<div class="mark">|</div>
					<div><a href="javascript:;">Website security</a></div>
				</div>
				<!-- <div class="bottomS"></div> -->
				<div class="copyright">© Super Airways - all rights reserved</div>
				<div class="bottomImg"><img src="../static/logo.png" alt="logo"></div>
			   
			</div>
	
	
		</div>
		<!--footer end-->
		<script type="text/javascript" >
			$(document).ready(function () {
				showTicketList();
			});
			function showTicketList(){
				$.ajax({
					url:"/tickets/",
					type:"POST",
					dataType:"JSON",
					success : function(json){
						if(json.state==200){
							let list = json.data;
							for (let i = 0; i < list.length; i++) {
								let tr ="\t\t\t\t\t\t\t\t<tr>\n" +
										"\t\t\t\t\t\t\t\t\t<td>BritishAirway</td>\n" +
										"\t\t\t\t\t\t\t\t\t<td>GP2312</td>\n" +
										"\t\t\t\t\t\t\t\t\t<td>day</td>\n" +
										"\t\t\t\t\t\t\t\t\t<td>time1</td>\n" +
										"\t\t\t\t\t\t\t\t\t<td>time2</td>\n" +
										"\t\t\t\t\t\t\t\t\t<td>London</td>\n" +
										"\t\t\t\t\t\t\t\t\t<td>Paris</td>\n" +
										"                                    <td>£<span>eco</span><div class='confirm_but'> <button onclick='supereClik(#{flightId})' >Book</button> </div></td>\n" +
										"                                    <td>£<span>busin</span> <div class='confirm_but'><button onclick='superbClik(#{flightId})' >Book</button> </div></td>\n" +
										"\t\t\t\t\t\t\t\t\t<td>£<span>first</span><div class='confirm_but'><button onclick='superfClik(#{flightId})' >Book</button> </div></td>\n" +
										"\t\t\t\t\t\t       </tr>";

								tr = tr.replace(/BritishAirway/g,list[i].company);
								tr = tr.replace(/GP2312/g,list[i].flightName);
								tr = tr.replace(/day/g,list[i].flightDay);
								tr = tr.replace(/time1/g,list[i].takeOffTime);
								tr = tr.replace(/time2/g,list[i].fallingOffTime);
								tr = tr.replace(/London/g,list[i].fromLocation);
								tr = tr.replace(/Paris/g,list[i].toLocation);
								tr = tr.replace(/eco/g,list[i].ecoPrice);
								tr = tr.replace(/busin/g,list[i].businessPrice);
								tr = tr.replace(/first/g,list[i].firstPrice);

								tr = tr.replace(/#{flightId}/g,list[i].flightId);
								$("#flight-body").append(tr);
							}
						}else { alert("Load failed");}
					}

				});
			}

			function supereClik(flightId){
				$.ajax({
					url:"/tickets/"+flightId+"/get_a_ticket",
					type:"POST",
					dataType:"JSON",
					success : function(json){
						if(json.state==200){
							//refresh page
							location.href="eco1.html";
						}else { alert("Set Failed");}
					},
					error:function (xhr){
						//弹出窗口
						alert("oops! An unknown error"+" "+xhr.message)
					}
				});
			}

		</script>




	</body>

</html>